<!-- letting angular know which controller to use for this view and when to show the view using ng-show -->
<div ng-controller="resultsCtrl as results" ng-show="results.quizMetrics.resultsActive">
    <div class="row">
        <div class="col-xs-8">
            <h2>Results:</h2>
            <div class="btn-toolbar">
                <!-- ng-repeat used again to loop through the possible answers to thequestions which are stored on -->
                <!-- the controller. The controller got that data from the quiz factory in js/factory/quiz.js -->

                <!-- ng-class is another angular directive. This directive will add a class to the element based  -->
                <!-- on the conditional it is provided. In this case it will add btn-sucess class if question.correct -->
                <!-- is true and will add btn-danger class if question.correct is false -->

                <!-- ng-click is again used to trigger a method on the controller called setActiveQuestion -->
                <!-- the method is passed the $index as an argument. $index is built into angular and holds -->
                <!-- the current index of the ng-repeat loop -->
                <button class="btn" 
                    ng-repeat="question in results.quizMetrics.questions" 
                    ng-class="{'btn-success': question.correct, 'btn-danger': !question.correct}"
                    ng-click="results.setActiveQuestion($index)">
                        <!-- display glyphicons -->
                        <!-- ng-class is utilsed again to style the glyphicons conditionally -->
                        <span class="glyphicon" 
                            ng-class="{'glyphicon-ok': question.correct, 'glyphicon-remove': !question.correct}"></span>
                </button>
            </div>
        </div>
        <div class="col-xs-4">
            <div class="row">
                <h4>Legend:</h4>
                <div class="col-sm-4">
                    <button class="btn btn-success">
                        <span class="glyphicon glyphicon-ok"></span>
                    </button>
                    <p>Correct</p>
                </div>
                <div class="col-xs-4">
                    <button class="btn btn-danger">
                        <span class="glyphicon glyphicon-remove"></span>
                    </button>
                    <p>Incorrect</p>
                </div>
            </div>
        </div><!-- col-xs-4 -->
    </div><!-- row -->

    <!-- display the score and percentage to the user -->
    <div class="row">
        <div class="col-xs-12 top-buffer">
            <!-- the score is displayed using simple angular expressions -->
            <h2>You scored {{results.quizMetrics.numCorrect}} / {{results.quizMetrics.questions.length}}</h2>
            <!-- the percentage is calculated using a method which is then filtered using the number filter -->
            <!-- which ensures only 2 decimal places will be shown -->
            <h2><strong>{{results.calculatePerc() | number:2}}%</strong></h2>
        </div>
    </div>
    <div class="row">
        <h3>Question:</h3>
        <div class="well well-sm">
            <div class="row">
                <div class="col-xs-12">
                    <!-- the below may look strange. -->
                    <!-- the angular expression will add 1 to the active question, because it is 0 index -->
                    <!-- it then displays it with a . after it followed by the question. -->
                    <!-- something like this "3. This is the third question:" -->
                    <h4>{{results.activeQuestion + 1 + ". " + results.quizMetrics.questions[results.activeQuestion].text}}</h4>
                    <div class="row"
                        ng-if="results.quizMetrics.questions[results.activeQuestion].type == 'text'">

                        <!-- ng-repeat being utilised again -->
                        <div class="col-sm-6"
                            ng-repeat="answer in results.quizMetrics.questions[results.activeQuestion].possibilities">
                                <h4 class="answer"
                                    ng-class="results.getAnswerClass($index)">
                                        {{ answer.answer }}
                                        <!-- more usage of the ng-show directive to selectively show the elements on condition -->
                                         <p ng-show="$index != results.quizMetrics.correctAnswers[results.activeQuestion] && $index === results.quizMetrics.questions[results.activeQuestion].selected" class="pull-right">Your Answer</p>
                                         <p ng-show="$index === results.quizMetrics.correctAnswers[results.activeQuestion] "class="pull-right">Correct Answer</p>
                                </h4>
                        </div>
                    </div>

                    <!-- more ng-show -->
                    <div class="row"
                        ng-if="results.quizMetrics.questions[results.activeQuestion].type == 'image'">

                        <!-- more ng-repeat -->
                        <div class="col-sm-6"
                            ng-repeat="answer in results.quizMetrics.questions[results.activeQuestion].possibilities">

                                <!-- ng-class, ng-click and ng-src -->
                                <div class="image-answer"
                                    ng-class="results.getAnswerClass($index)"
                                    ng-click="results.selectAnswer($index)">
                                    <img ng-src="{{answer.answer}}">
                                </div>

                        </div>

                </div>
            </div>
        </div>
        <!-- ng-click calling the reset method on the controller -->
        <button class="btn btn-primary btn-lg" ng-click="results.reset()">Go Back Facts</button>
    </div>
</div>
